!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/router"),require("@angular/platform-browser"),require("lodash"),require("typexs-schema/libs/PropertyDef"),require("typexs-base/libs/exceptions/NotYetImplementedError"),require("typexs-schema/libs/EntityDef"),require("typexs-schema/libs/Registry"),require("typexs-schema/libs/DataContainer"),require("rxjs/Observable"),require("@angular/forms")):"function"==typeof define&&define.amd?define("@typexs-ng/base",["exports","@angular/core","@angular/router","@angular/platform-browser","lodash","typexs-schema/libs/PropertyDef","typexs-base/libs/exceptions/NotYetImplementedError","typexs-schema/libs/EntityDef","typexs-schema/libs/Registry","typexs-schema/libs/DataContainer","rxjs/Observable","@angular/forms"],e):e((t["typexs-ng"]=t["typexs-ng"]||{},t["typexs-ng"].base={}),t.ng.core,t.ng.router,t.ng.platformBrowser,t._,t.PropertyDef,t.NotYetImplementedError,t.EntityDef,t.Registry,t.DataContainer,t.rxjs.Observable,t.ng.forms)}(this,function(t,i,e,n,x,w,b,C,O,r,o,a){"use strict";var s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};function c(t,e){function n(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function l(t,e,n,r){var o,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;0<=s;s--)(o=t[s])&&(a=(i<3?o(a):3<i?o(e,n,a):o(e,n))||a);return 3<i&&a&&Object.defineProperty(e,n,a),a}function u(n,r){var o,i,a,t,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return t={next:e(0),"throw":e(1),"return":e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(a=i[2&t[0]?"return":t[0]?"throw":"next"])&&!(a=a.call(i,t[1])).done)return a;switch(i=0,a&&(t=[0,a.value]),t[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,i=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=r.call(n,s)}catch(e){t=[6,e],i=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([e,t])}}}function j(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}var p=function(){},f=function(){function t(t){this.routes=[];try{for(var e=j(t.config),n=e.next();!n.done;n=e.next()){var r=n.value,o=new p;o.label=r.data.label,o.path=r.path,this.routes.push(o)}}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=e["return"])&&a.call(e)}finally{if(i)throw i.error}}var i,a}return t.decorators=[{type:i.Component,args:[{selector:"nav-root",templateUrl:"./navigator.component.html"}]}],t.ctorParameters=function(){return[{type:e.Router}]},t}(),h=function(){function t(){}return t.decorators=[{type:i.NgModule,args:[{declarations:[f],imports:[n.BrowserModule,e.RouterModule],exports:[f],providers:[]}]}],t}(),v=function(){function t(t,e,n){this.path=[],this.fetchKey=null,this.property=null,this.object=null,this.property=n,this.object=e,this.orgValue=t.replace(/^\$/,""),this.path=this.orgValue.split("."),this.fetchKey=this.path.pop()}return t.prototype.get=function(){return this.orgValue},t.prototype.resolve=function(t){var e=t.get(this.path.join("."));if(e)return this.object[this.property]=e[this.fetchKey],e[this.fetchKey];throw new Error("cant resolve data")},t}();function d(t){return t instanceof y}var y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.usedKeys=[],t.binding=null,t}return c(t,e),t.prototype.getBinding=function(){return this.binding},t.prototype.getUsedKeys=function(){return this.usedKeys},t.prototype.getPath=function(){var t=[];if(this.getBinding()instanceof w.PropertyDef){if(this.getParent()){var e=this.getParent();d(e)&&t.push(e.getPath())}t.push(this.name),this.getBinding().isCollection()&&t.push("$idx")}return x.filter(t,function(t){return""!=t.trim()}).join(".")},t.prototype.getForm=function(){return this.parent&&d(this.parent)?this.parent.getForm():"form"==this.type?this:null},t.prototype.handle=function(t,e){e instanceof v&&this.getForm().resolver.push(e);this.usedKeys.push(t);var n="handle"+x.capitalize(t);this[n]?this[n](e):this[t]=e},t.prototype.handleType=function(t){},t.prototype.postProcess=function(){},t.prototype.replace=function(t){var e=this.getParent(),n=e.getChildren().indexOf(this);if(n<0)throw new Error("can not find index, something is wrong");return(e.getChildren()[n]=t).setParent(e),t},t}(function(){function t(){this.parent=null,this.children=[]}return t.prototype.insert=function(t){t.parent=this,t.index=this.children.length,this.children.push(t)},t.prototype.getParent=function(){return this.parent},t.prototype.setParent=function(t){t&&(this.parent=t,this.index=this.parent.children.indexOf(this))},t.prototype.getChildren=function(){return this.children},t}()),m=function(e){function t(t){return e.call(this,t+" not defined")||this}return c(t,e),t}(Error),P=function(){function t(){this.formHandler=[]}return t.$=function(){return this.$self||(this.$self=new t),this.$self},t.prototype.getOrCreateDef=function(t){var e=x.find(this.formHandler,{type:t});return e||(e={type:t},this.formHandler.push(e)),e},t.prototype.getDef=function(t){return x.find(this.formHandler,{type:t})},t.addHandler=function(t,e){var n=this.$().getOrCreateDef(t);return n.handler=e,n},t.addComponent=function(t,e){var n=this.$().getOrCreateDef(t);return n.component=e,n},t.createHandler=function(t){var e=this.$().getOrCreateDef(t);if(!e||!e.handler)throw new m(t);var n=Reflect.construct(e.handler,[]);return n.type=t,n},t.createComponent=function(t){var e=this.$().getOrCreateDef(t);if(!e||!e.component)throw new m(t);var n=Reflect.construct(e.component,[]);return n.type=t,n},t.$self=null,t}();function g(e){return function(t){P.addHandler(e,t)}}(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}c(e,t),e=l([g("tabs")],e)})(y),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}c(e,t),e=l([g("tab")],e)}(y);var _=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return c(e,t),e.prototype.postProcess=function(){this.getForm().resolver.push(this)},e.prototype.resolve=function(t){var e=this,n=t.get(this.use);if(d(n)){var r=x.clone(n);this.replace(r),this.getUsedKeys().forEach(function(t){r.handle(t,e[t])})}},e=l([g("ref")],e)}(y),D=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.variant="text",t}return c(t,e),t.prototype.handleVariant=function(t){this.variant=t},t=l([g("input")],t)}(y),E=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.resolver=[],t}c(t,e),t.prototype.combine=function(t){for(var e=[];0<this.resolver.length;){(n=this.resolver.shift())instanceof v?n.resolve(t):e.push(n)}for(;0<e.length;){var n;(n=e.shift())instanceof _&&n.resolve(t)}return this},t.prototype.get=function(t){for(var e=t.split("."),n=this,r=null;0<e.length;){var o=e.shift();if(!(n=x.find(n.getChildren(),{name:o})))break;r=n}return 0==e.length&&r?r:null},t=l([g("form")],t)}(y),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}c(e,t),e=l([g("checkbox")],e)}(D),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}c(e,t),e=l([g("radio")],e)}(D),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}c(e,t),e=l([g("select")],e)}(y),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}c(e,t),e=l([g("grid")],e)}(y),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return c(e,t),e}(Error)),R=function(){function t(){}return t.prototype.buildFromJSON=function(t){return this.data=t,this.schema=O.Registry.getSchema("default"),this._buildForm(t)},t.prototype.buildFromEntity=function(t){return this.data=t,this._buildFormObject(t)},t.prototype._buildFormObject=function(t,e){void 0===e&&(e=null);var n,r,o,i,a=null;if(this.form){if(t instanceof w.PropertyDef){var s=(f=t).getOptions("form")||"text",c="for"+x.capitalize(s);a=this[c]?this[c](s,f):this.forDefault(s,f)}}else this.schema=O.Registry.getSchema(t.schemaName),this.form=a=P.createHandler("form"),a.handle("name",t.id()),a.handle("binding",t);if(null!=a?a.setParent(e):a=e,t instanceof C.EntityDef){var l=t.getPropertyDefs();try{for(var u=j(l),p=u.next();!p.done;p=u.next()){var f=p.value,h=this._buildFormObject(f,a);a.insert(h)}}catch(b){n={error:b}}finally{try{p&&!p.done&&(r=u["return"])&&r.call(u)}finally{if(n)throw n.error}}}else if(t instanceof w.PropertyDef){if((f=t).isReference())if(f.isEntityReference()){var d=f.targetRef.getEntity();h=this._buildFormObject(d,a);a.insert(h)}else{l=this.schema.getPropertiesFor(f.targetRef.getClass());try{for(var y=j(l),m=y.next();!m.done;m=y.next()){var g=m.value;h=this._buildFormObject(g,a);a.insert(h)}}catch(v){o={error:v}}finally{try{m&&!m.done&&(i=y["return"])&&i.call(y)}finally{if(o)throw o.error}}}}return a.postProcess(),a},t.prototype.forDefault=function(t,e){var n=P.createHandler(t);if(n)return n.handle("variant",t),this._applyValues(n,e),n;throw new E(t)},t.prototype.forText=function(t,e){return this._forInput(t,e)},t.prototype.forPassword=function(t,e){return this._forInput(t,e)},t.prototype.forEmail=function(t,e){return this._forInput(t,e)},t.prototype._forInput=function(t,e){var n=P.createHandler("input");return n.handle("variant",t),this._applyValues(n,e),n},t.prototype._applyValues=function(n,t){n.handle("name",t.name),n.handle("id",t.id()),n.handle("label",t.label?t.label:x.capitalize(t.name)),n.handle("binding",t);var r=t.getOptions();r&&Object.keys(r).forEach(function(t){if(!/^(source|target|property)/.test(t)){var e=r[t];n.handle(t,e)}})},t.prototype._buildForm=function(t,e){void 0===e&&(e=null);var n,r,o,i,a=x.remove(Object.keys(t),function(t){return-1===["children","type"].indexOf(t)}),s=null;if(!t.type)throw new E;s=P.createHandler(t.type),this.form||(this.form=s),s.setParent(e);try{for(var c=j(a),l=c.next();!l.done;l=c.next()){var u=l.value,p=t[u];x.isString(p)&&/^\$/.test(p)&&(p=new v(p,s,u)),s.handle(u,p)}}catch(m){n={error:m}}finally{try{l&&!l.done&&(r=c["return"])&&r.call(c)}finally{if(n)throw n.error}}if(t.children){p=t.children;if(!x.isArray(p))throw new b.NotYetImplementedError;try{for(var f=j(p),h=f.next();!h.done;h=f.next()){var d=h.value,y=this._buildForm(d,s);s.insert(y)}}catch(g){o={error:g}}finally{try{h&&!h.done&&(i=f["return"])&&i.call(f)}finally{if(o)throw o.error}}}return s.postProcess(),s},t}(),F=function(){function t(){this.cache={}}return t.prototype.get=function(t,e){var n=O.Registry.getEntityDefFor(e);return(new R).buildFromEntity(n)},t.decorators=[{type:i.Injectable}],t}();function I(e){return function(t){P.addComponent(e,t)}}var S="__prop__metadata__",k=function(){function t(t,e){this.injector=t,this.r=e,this.construct()}return t.prototype.construct=function(){},t.prototype.setElem=function(t){this.elem=t},t.prototype.buildSingle=function(t){var e=P.$().getOrCreateDef(t.type);if(!e||!e.component)throw new E(t.type);if(this.vc){var n=this.r.resolveComponentFactory(e.component),r=this.vc.createComponent(n).instance,o=null;if(r.constructor.hasOwnProperty(S)&&(o=r.constructor[S]),r.setElem(t),r.build){var i=r.build(t);o&&Object.keys(o).forEach(function(t){var e=o[t];if(!x.isEmpty(e))if(x.isArray(e)&&1===e.length){var n=x.first(e);x.isFunction(n.selector)&&(n.first?(r[t]=x.find(i,function(t){return t.constructor==n.selector}),r[t+"2"]=x.find(i,function(t){return t.constructor==n.selector})):(r[t]=x.filter(i,function(t){return t.constructor==n.selector}),r[t+"2"]=x.filter(i,function(t){return t.constructor==n.selector})))}else console.error("can't resolve metadata",r.constructor,t,e)})}return r}return console.error("No view content setted"),null},t.prototype.build=function(t){var n=this,r=[];return t.getChildren().forEach(function(t){var e=n.buildSingle(t);r.push(e)}),r},t.ctorParameters=function(){return[{type:i.Injector,decorators:[{type:i.Inject,args:[i.Injector]}]},{type:i.ComponentFactoryResolver,decorators:[{type:i.Inject,args:[i.ComponentFactoryResolver]}]}]},t.propDecorators={vc:[{type:i.ViewChild,args:["content",{read:i.ViewContainerRef}]}]},t}(),N=function(){function r(){this.idx=-1}return r.prototype.child=function(t,e){void 0===t&&(t=null),void 0===e&&(e=-1);var n=new r;return n.parent=this,n.name=t,n.idx=e,n},r.prototype.path=function(){var t=[];return this.parent&&(t=this.parent.path().split(".")),-1<this.idx?t[t.length-1]=t[t.length-1]+"["+this.idx+"]":t.push(this.name),x.filter(t,function(t){return!x.isEmpty(t)}).join(".")},r.prototype.get=function(t,e){return void 0===e&&(e=null),x.has(this,t)?x.get(this,t,e):this.parent?this.parent.get(t):e},r}(),B=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.inc=0,t}return c(t,e),t.prototype.construct=function(){this.inc=t._inc++},Object.defineProperty(t.prototype,"id",{get:function(){return this.elem.id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.elem.name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"label",{get:function(){return this.elem.label},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"labelDisplay",{get:function(){return this.context.get("labelDisplay","top")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"help",{get:function(){return this.elem.help},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isReadOnly",{get:function(){return this.elem.readonly},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isValid",{get:function(){return this.data.checked(this.name)&&this.data.valid(this.name)},enumerable:!0,configurable:!0}),t.prototype.setFormObject=function(t){this.setElem(t)},t.prototype.setData=function(t,e,n){void 0===n&&(n=-1),this.setFormObject(t),e?this.context=e.child(t.name,n):(this.context=new N,t.getBinding()instanceof w.PropertyDef&&(this.context.name=t.name,this.context.idx=n))},Object.defineProperty(t.prototype,"value",{get:function(){var t=this.context.path();return x.get(this.data.instance,t,null)},set:function(t){var e=this.context.path();x.set(this.data.instance,e,t)},enumerable:!0,configurable:!0}),t.prototype.build=function(t){var o=this,i=[];return t.getChildren().forEach(function(t){if(d(t)){var e=P.$().getOrCreateDef(t.type);if(!e||!e.component)throw new E(t.type);if(o.vc){var n=o.r.resolveComponentFactory(e.component),r=o.vc.createComponent(n).instance;r.data=o.data,r.setData(t,o.context),r.build(t),i.push(r)}else console.error("No view content setted")}}),i},t._inc=0,t}(k),$=function(o){function t(t,e,n){var r=o.call(this,e,n)||this;return r.formService=t,r.injector=e,r.r=n,r.ngSubmit=new i.EventEmitter,r}return c(t,o),t.prototype.ngOnInit=function(){this.data=new r.DataContainer(this.instance),this.elem=this.formService.get(this.formName,this.instance),this.build(this.elem)},t.prototype.onSubmit=function(e){return a=this,l=function(){return u(this,function(t){switch(t.label){case 0:return[4,this.data.validate()];case 1:return t.sent(),this.ngSubmit.emit({event:e,data:this.data}),[2,!1]}})},new((c=s=void 0)||(c=Promise))(function(t,n){function r(t){try{i(l.next(t))}catch(e){n(e)}}function o(t){try{i(l["throw"](t))}catch(e){n(e)}}function i(e){e.done?t(e.value):new c(function(t){t(e.value)}).then(r,o)}i((l=l.apply(a,s||[])).next())});var a,s,c,l},t.decorators=[{type:i.Component,args:[{selector:"xform",templateUrl:"./form.component.html"}]}],t.ctorParameters=function(){return[{type:F,decorators:[{type:i.Inject,args:[F]}]},{type:i.Injector,decorators:[{type:i.Inject,args:[i.Injector]}]},{type:i.ComponentFactoryResolver,decorators:[{type:i.Inject,args:[i.ComponentFactoryResolver]}]}]},t.propDecorators={ngSubmit:[{type:i.Output}],formName:[{type:i.Input}],instance:[{type:i.Input}]},t=l([I("form"),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[F,i.Injector,i.ComponentFactoryResolver])],t)}(B),H=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return c(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this.elem.variant},enumerable:!0,configurable:!0}),e.decorators=[{type:i.Component,args:[{selector:"xinput",templateUrl:"./input.component.html"}]}],e=l([I("input")],e)}(B),M=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return c(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this.elem.variant},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isChecked",{get:function(){return this.data.instance[this.name]},set:function(t){this.data.instance[this.name]=!!t},enumerable:!0,configurable:!0}),e.decorators=[{type:i.Component,args:[{selector:"xcheckbox",templateUrl:"./checkbox.component.html"}]}],e=l([I("checkbox")],e)}(B),U=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.on="Yes",t.off="No",t}return c(t,e),Object.defineProperty(t.prototype,"type",{get:function(){return this.elem.variant},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isChecked",{get:function(){return this.data.instance[this.name]},set:function(t){this.data.instance[this.name]=!!t},enumerable:!0,configurable:!0}),t.decorators=[{type:i.Component,args:[{selector:"xradio",templateUrl:"./radio.component.html"}]}],t=l([I("radio")],t)}(B),q=function(){this.value="",this.label="---"},V=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.cachedOptions=[],t}return c(t,e),Object.defineProperty(t.prototype,"supportsMultiple",{get:function(){return this.elem.getBinding().isCollection()},enumerable:!0,configurable:!0}),t.prototype.ngOnInit=function(){this.cachedOptions=[],this.loadOptions()},t.prototype.loadOptions=function(){var n=this,t=this.retrieveEnum();t&&(t instanceof o.Observable?t.subscribe(function(t){var e=new q;if(x.isString(t))e.label=e.value=t;else{if(!x.has(t,"label")&&!x.has(t,"value"))throw new Error("not found");e.label=x.get(t,"label",x.get(t,"value")),e.value=x.get(t,"value",x.get(t,"label"))}n.cachedOptions.push(e)}):t.forEach(function(t){var e=new q;if(x.isString(t))e.label=e.value=t;else{if(!x.has(t,"label")&&!x.has(t,"value"))throw new Error("not found");e.label=x.get(t,"label",x.get(t,"value")),e.value=x.get(t,"value",x.get(t,"label"))}n.cachedOptions.push(e)}))},t.prototype.retrieveEnum=function(){if(x.isArray(this.elem["enum"]))return this.elem["enum"];if(x.isFunction(this.elem["enum"]))return this.injector.get(this.elem["enum"]).get(this.name);if(x.isString(this.elem["enum"])){var t=[];if(this.context.parent&&t.push(this.context.parent.path()),t.push(this.elem["enum"]),t=t.join("."),x.has(this.data.instance,t))return x.get(this.data.instance,t,[]);throw new Error("not found enum reference")}return[]},t.decorators=[{type:i.Component,args:[{selector:"xselect",templateUrl:"./select.component.html"}]}],t=l([I("select")],t)}(B),K=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return c(e,t),Object.defineProperty(e.prototype,"hostClasses",{get:function(){return["col"].join(" ")},enumerable:!0,configurable:!0}),e.prototype.setGridComponent=function(t){this.grid=t},e.decorators=[{type:i.Component,args:[{selector:"xgridcell",templateUrl:"./grid-cell.component.html"}]}],e.propDecorators={hostClasses:[{type:i.HostBinding,args:["class"]}]},e}(B),G=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return c(e,t),e.prototype.setGridComponent=function(t){this.grid=t},Object.defineProperty(e.prototype,"hostClasses",{get:function(){return["form-row"].join(" ")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"idx",{get:function(){return this.context.idx},enumerable:!0,configurable:!0}),e.prototype.removeRow=function(){this.grid.removeRow(this.context.idx)},e.prototype.build=function(t){var a=this,s=[];return t.getChildren().forEach(function(t){if(d(t)){var e=P.$().getOrCreateDef(t.type);if(!e||!e.component)throw new E(t.type);var n=a.r.resolveComponentFactory(K),r=a.vc.createComponent(n);if(r.instance.data=a.data,r.instance.setGridComponent(a.grid),r.instance.setData(t,a.context),r.instance.vc){var o=a.r.resolveComponentFactory(e.component),i=r.instance.vc.createComponent(o).instance;i.data=a.data,i.setData(t,a.context),i.build(t),s.push(i)}else console.error("No view content setted")}}),s},e.decorators=[{type:i.Component,args:[{selector:"xgridrow",templateUrl:"./grid-row.component.html"}]}],e.propDecorators={hostClasses:[{type:i.HostBinding,args:["class"]}]},e}(B),Y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.entries=[],t.header=[],t}return c(t,e),t.prototype.ngOnInit=function(){},t.prototype.addRow=function(t){void 0===t&&(t=-1);var e=this.r.resolveComponentFactory(G),n=this.vc.createComponent(e);n.instance.data=this.data,n.instance.setGridComponent(this),n.instance.setData(this.elem,this.context,this.entries.length),this.entries.push(n);var r=Reflect.construct(this.elem.getBinding().targetRef.getClass(),[]),o=this.context.path();if(this.elem.getBinding().isCollection()){var i=x.get(this.data.instance,o,null);i||(i=[]),i[n.instance.context.idx]=r,x.set(this.data.instance,o,i)}else x.set(this.data.instance,o,r);return n.instance.build(this.elem),n.instance},t.prototype.removeRow=function(t){var e=this.context.path(),n=this.entries.splice(t,1).shift();if(this.vc.remove(t),this.elem.getBinding().isCollection()){var r=x.get(this.data.instance,e,null);r||(r=[]),r.splice(t,1),x.set(this.data.instance,e,r)}else x.set(this.data.instance,e,null);for(var o=this.entries.length-1;0<=o;o--)this.entries[o].instance.context.idx=o;n.destroy()},t.prototype.build=function(t){var e=this;this.context.labelDisplay="none",t.getChildren().forEach(function(t){d(t)&&e.header.push(t.label)});this.elem.getBinding().get(this.data.instance);return[this.addRow()]},t.decorators=[{type:i.Component,args:[{selector:"xgrid",templateUrl:"./grid.component.html"}]}],t=l([I("grid")],t)}(B),A=[$,H,M,U,V,Y,G,K],z=function(){function t(){}return t.decorators=[{type:i.NgModule,args:[{declarations:A,imports:[a.FormsModule,n.BrowserModule],entryComponents:A,exports:A,providers:[F]}]}],t}(),T=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._build=!1,t}return c(t,e),Object.defineProperty(t.prototype,"instance",{get:function(){return this._instance},set:function(t){this._instance=t,this._build=!1,this.__build()},enumerable:!0,configurable:!0}),t.prototype.ngOnInit=function(){this.__build()},t.prototype.__build=function(){this._build||(this.vc.clear(),this.buildSingle(this._instance),this._build=!0)},t.decorators=[{type:i.Component,args:[{selector:"view-builder",templateUrl:"./view-builder.component.html"}]}],t.propDecorators={instance:[{type:i.Input}]},t}(k),J=function(){function t(){}return t.decorators=[{type:i.NgModule,args:[{declarations:[T],imports:[n.BrowserModule],entryComponents:[],exports:[T],providers:[]}]}],t}();t.NavigatorModule=h,t.xFormsModule=z,t.xViewsModule=J,t.ɵd=B,t.ɵe=k,t.ɵf=I,t.ɵa=f,t.ɵi=M,t.ɵc=$,t.ɵg=F,t.ɵn=K,t.ɵm=G,t.ɵl=Y,t.ɵh=H,t.ɵj=U,t.ɵk=V,t.ɵb=A,t.ɵo=T,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=typexs-ng-base.umd.min.js.map